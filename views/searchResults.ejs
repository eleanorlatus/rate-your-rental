<%- include('partials/header') -%>
<div class="py-4 sm:p-5">
  <h1 class="text-2xl 2xl:text-3xl font-bold pb-2">Search results: </h1>
  <!-- alert div-->
<div class="mx-auto w-full md:w-2/5 px-5">
  <% if (locals.messages.errors) { %> <% messages.errors.forEach( el => { %>
    <div class="alert alert-error shadow-lg">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current flex-shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
        <span><%= el.msg %></span>
      </div>
    </div>
          <% }) %> <% } %> <% if (locals.messages.info) { %> <%
          messages.info.forEach( el => { %>
            <div class="alert alert-error shadow-lg">
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current flex-shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span><%= el.msg %></span>
              </div>
            </div>
          <% }) %> <% } %>
</div>


    <% for(var i=0; i<property.length; i++) {%>
      <!-- review -->
    <div class="lg:grid lg:grid-cols-3">
    <div class="lg:col-span-1 lg:block lg:border-b-2 border-primary-focus max-w-xl mx-auto">
          <div class="p-2 my-2 md:my-4">
            <a href="/property/<%= property[i]._id%>"><img src="<%= property[i].images[0].url%>" class=" mx-auto w-4/5"></a>
          </div>
    </div>
    <div class="lg:col-span-2 border-b-2 border-primary-focus">
      <!-- outer review div-->
      <div class="px-2 py-1 my-2 md:px-8 md:py-4 md:my-4">
        <h3 class="text-xl 2xl:text-2xl font-bold pb-2"><a href="/property/<%= property[i]._id%>" class="black"><%= property[i].streetName%>, <%= property[i].postcode%></a></h3>
        
        <% for(var j=0; j<property[i].reviews.length; j++) {%>
          <% for(var l=0; l<reviews.length; l++) {%>
          <%if(reviews[l]._id == property[i].reviews[j]){ %>
          <h3>Review posted by <a href="/profile/<%= reviews[l].user.userName%>"><%= reviews[l].user.userName%></a></h3>
          <p class="hidden md:block py-1"><a href="/property/<%= property[i]._id%>" class="black hover-black"><%= reviews[l].body.split(" ").slice(0,30).join(" ")%> ...</a></p>
          <p class="md:hidden py-1"><a href="/property/<%= property[i]._id%>" class="black hover-black"><%= reviews[l].body.split(" ").slice(0,15).join(" ")%> ...</a></p>
        <% } %>
        <% } %>
        <% } %>
      </div>
    </div>
    </div>
    <% } %>
  </div>
</div>


<%- include('partials/footer') -%>